---
title: 22. 括号生成
difficulty: 中等
related: 字符串|排列组合|递归
---

## 题目

给出`n`代表生成括号的对数，请你写出一个函数，使其能够生成所有可能的并且**有效的**括号组合。

## 示例

**输入：** 3

**输出：** ["()()()", "(())()", "()(())", "(()())", "((()))"]

## 解析

这又是一道排列组合的题，与第17题键盘组合稍有不同，但同样可以利用递归来解决。

首先，我们可以来看下怎么构造有效的括号。最简单的，假如给定一个字符串是`()`，那么通过它可以衍生出什么呢？

我们将`()`这个字符串进行分割可以得到`(`和`)`，一共有3个位置可以插入新的`()`。即：

1. `0()` => 0的位置插入新`()`，得到`()()`
2. `(1)` => 1的位置插入新`()`，得到`(())`
3. `()2` => 2的位置插入新`()`，得到`()()`

由于上述的第一种和第三种结果是相同的，所以进行去重后得到的结果就是`["()()", "(())"]`。

其实经过上述两步，我们已经根据`n=1`的结果推导出`n=2`的结果。相似地，可以依次推出`n=3,4,5...`的结果，利用递归的方法即可。

最后，还有一小点可以优化的是，我们可以将中间计算得到的结果缓存下来，这样可以减少重复的计算。

## 代码

```javascript
const cache = [, ['()']];

/**
 * @param {number} n
 * @return {string[]}
 */
var generateParenthesis = function(n) {
  if(cache[n]) {
    return cache[n];
  } else {
    const ret = [];
    const tmp = generateParenthesis(n - 1);
    tmp.forEach(str => {
      for(let i = 0, len = str.length; i <= len; i++) {
        const s = str.substring(0, i) + '()' + str.substring(i, len);
        ret.push(s);
      }
    });
    cache[n] = Array.from(new Set(ret));
    return cache[n];
  }
};

// tesing code
[
  1,    // ["()"]
  2,    // ["()()", "(())"]
  3,    // ["()()()", "(())()", "()(())", "(()())", "((()))"]
].forEach(n => {
  console.log(generateParenthesis(n));
});
```